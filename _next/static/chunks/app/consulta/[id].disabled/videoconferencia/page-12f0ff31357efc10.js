(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8376],{657:function(e,s,t){Promise.resolve().then(t.bind(t,6482))},6482:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return d},dynamicParams:function(){return c}});var o=t(7437),a=t(2265),r=t(4033),n=t(2481),l=t(1981),i=t(6264);let c=!1;function d(){let e=(0,r.useRouter)(),s=(0,r.usePathname)(),t=parseInt((null==s?void 0:s.split("/")[2])||"0"),[c,d]=(0,a.useState)(null),[u,m]=(0,a.useState)(!0),[x,h]=(0,a.useState)(null),[f,p]=(0,a.useState)(""),[g,b]=(0,a.useState)(""),[N,j]=(0,a.useState)(null),[v,w]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!t||isNaN(t)){h("ID da consulta inv\xe1lido"),m(!1);return}{let e=new URLSearchParams(window.location.search).get("nif");e?(d(e),b(e),y(new Event("submit"),e)):m(!1)}},[t]);let y=async(e,s)=>{e&&e.preventDefault();let o=s||g.trim();if(!o){h("Por favor, insira o seu NIF");return}try{var a;m(!0),h(null),console.log("Buscando token para paciente:",{consultaId:t,nif:o});let e="".concat("https://clamatec.com/api","/public/daily/").concat(t,"/token?nif=").concat(encodeURIComponent(o));console.log("URL da API:",e);let s=await fetch(e);if(console.log("Resposta da API:",{status:s.status,ok:s.ok}),!s.ok){let e=await s.json().catch(()=>({message:"Erro ao validar acesso"}));throw console.error("Erro ao obter token:",e),Error(e.message||"Erro ".concat(s.status,": NIF n\xe3o corresponde \xe0 consulta ou consulta n\xe3o encontrada"))}let r=await s.json();if(console.log("Dados recebidos:",{hasToken:!!r.token,hasRoom:!!r.room,roomUrl:null===(a=r.room)||void 0===a?void 0:a.url}),!r.token||!r.room)throw console.error("Dados incompletos:",r),Error("Token ou URL da sala n\xe3o recebidos do servidor");j(r),p(o),w(!0)}catch(e){h(e.message||"Erro ao validar acesso")}finally{m(!1)}};if(v&&N&&N.token&&N.room){let s=N.room.url,a=N.token,r=N.room.user_name||"Paciente";return(console.log("Renderizando DailyVideoModalPaciente:",{consultaId:t,roomUrl:s,hasToken:!!a,tokenLength:null==a?void 0:a.length,userName:r}),s&&a)?(0,o.jsx)(n.Z,{isOpen:!0,onClose:()=>{w(!1),e.push("/")},consultaId:t,nomeUsuario:r,roomUrl:s,token:a}):(console.error("Dados incompletos para renderizar:",{roomUrl:s,hasToken:!!a}),(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center p-4",children:(0,o.jsx)("div",{className:"max-w-md w-full bg-white rounded-xl shadow-2xl p-8",children:(0,o.jsx)("div",{className:"text-center",children:(0,o.jsx)("p",{className:"text-red-600",children:"Erro: Dados incompletos para acessar a videoconfer\xeancia"})})})}))}return(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center p-4",children:(0,o.jsxs)("div",{className:"max-w-md w-full bg-white rounded-xl shadow-2xl p-8",children:[(0,o.jsxs)("div",{className:"text-center mb-8",children:[(0,o.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,o.jsx)(l.Z,{className:"w-8 h-8 text-green-600"})}),(0,o.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Acesso \xe0 Videoconfer\xeancia"}),(0,o.jsx)("p",{className:"text-gray-600",children:"Digite o seu NIF para acessar a consulta online"})]}),x&&(0,o.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,o.jsxs)("div",{className:"flex items-start gap-3",children:[(0,o.jsx)(l.Z,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),(0,o.jsx)("p",{className:"text-sm text-red-800",children:x})]})}),(0,o.jsxs)("form",{onSubmit:y,className:"space-y-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"nif",className:"block text-sm font-medium text-gray-700 mb-2",children:"NIF (N\xfamero de Identifica\xe7\xe3o Fiscal)"}),(0,o.jsx)("input",{type:"text",id:"nif",value:g,onChange:e=>b(e.target.value),placeholder:"Digite o seu NIF",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all",disabled:u,required:!0}),(0,o.jsx)("p",{className:"mt-2 text-xs text-gray-500",children:"O NIF deve corresponder ao paciente da consulta"})]}),(0,o.jsx)("button",{type:"submit",disabled:u||!g.trim(),className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:u?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.Z,{className:"w-5 h-5 animate-spin"}),"Validando..."]}):"Acessar Videoconfer\xeancia"})]}),(0,o.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,o.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"Precisa de ajuda? Entre em contato com o hospital."})})]})})}}},function(e){e.O(0,[2766,2971,4938,1744],function(){return e(e.s=657)}),_N_E=e.O()}]);