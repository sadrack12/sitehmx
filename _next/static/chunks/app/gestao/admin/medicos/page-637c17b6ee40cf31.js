(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6578],{2389:function(e,a,s){Promise.resolve().then(s.bind(s,5708))},5708:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return h}});var r=s(7437),t=s(2265),l=s(8565),i=s(4033),n=s(6264),o=s(9883),c=s(7607),d=s(9670),m=s(9617),x=s(1138),g=s(3242),u=s(3930),p=s(7552);function h(){let{user:e,token:a,loading:s}=(0,l.a)(),h=(0,i.useRouter)(),[f,y]=(0,t.useState)([]),[j,b]=(0,t.useState)(!0),[N,v]=(0,t.useState)(!1),[w,_]=(0,t.useState)(!1),[E,C]=(0,t.useState)(null),[k,S]=(0,t.useState)(null),[A,O]=(0,t.useState)({nome:"",crm:"",especialidade:"",email:"",telefone:"",criar_login:!1,login_email:"",login_password:""}),[T,Z]=(0,t.useState)(!1),[M,q]=(0,t.useState)({isOpen:!1,id:null});(0,t.useEffect)(()=>{s||e?e&&"admin"!==e.role&&h.push("/gestao/dashboard"):h.push("/gestao/login")},[e,s,h]);let z=(0,t.useCallback)(async()=>{try{b(!0);let e=await fetch("".concat("https://clamatec.com/api","/admin/medicos"),{headers:{Authorization:"Bearer ".concat(a)}});if(e.ok){let a=await e.json();y(a.data||a||[])}else g.A.error("Erro ao carregar m\xe9dicos")}catch(e){console.error("Erro ao buscar m\xe9dicos:",e),g.A.error("Erro ao carregar m\xe9dicos")}finally{b(!1)}},[a]);(0,t.useEffect)(()=>{e&&"admin"===e.role&&z()},[e,z]);let D=async e=>{e.preventDefault(),Z(!0);try{let e=E?"".concat("https://clamatec.com/api","/admin/medicos/").concat(E.id):"".concat("https://clamatec.com/api","/admin/medicos"),s={nome:A.nome,crm:A.crm,especialidade:A.especialidade,email:A.email,telefone:A.telefone,criar_login:A.criar_login,login_email:A.login_email,login_password:A.login_password},r=await fetch(e,{method:E?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify(s)});if(!r.ok){let e=await r.json();throw Error(e.message||"Erro ao salvar m\xe9dico")}g.A.success(E?"M\xe9dico atualizado com sucesso!":"M\xe9dico criado com sucesso!"),await z(),F()}catch(e){console.error("Erro ao salvar m\xe9dico:",e),g.A.error(e.message||"Erro ao salvar m\xe9dico")}finally{Z(!1)}},P=async()=>{if(M.id)try{(await fetch("".concat("https://clamatec.com/api","/admin/medicos/").concat(M.id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}})).ok?(g.A.success("M\xe9dico exclu\xeddo com sucesso!"),z()):g.A.error("Erro ao excluir m\xe9dico")}catch(e){g.A.error("Erro ao excluir m\xe9dico")}finally{q({isOpen:!1,id:null})}},B=e=>{var a;C(e),O({nome:e.nome,crm:e.crm,especialidade:e.especialidade,email:e.email||"",telefone:e.telefone||"",criar_login:!1,login_email:(null===(a=e.user)||void 0===a?void 0:a.email)||"",login_password:""}),v(!0)},F=()=>{O({nome:"",crm:"",especialidade:"",email:"",telefone:"",criar_login:!1,login_email:"",login_password:""}),C(null),v(!1)};return s||j?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)(n.Z,{className:"w-8 h-8 animate-spin text-green-600"})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"M\xe9dicos"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"Gerencie os m\xe9dicos do hospital"})]}),(0,r.jsxs)("button",{onClick:()=>v(!0),className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors text-sm font-medium",children:[(0,r.jsx)(o.Z,{className:"w-5 h-5"}),"Novo M\xe9dico"]})]}),N&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 border border-gray-200",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:E?"Editar M\xe9dico":"Novo M\xe9dico"}),(0,r.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nome ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",value:A.nome,onChange:e=>O({...A,nome:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-1 focus:ring-green-500 focus:border-green-500 outline-none text-sm",placeholder:"Nome completo"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["N\xba Ordem ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",value:A.crm,onChange:e=>O({...A,crm:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-1 focus:ring-green-500 focus:border-green-500 outline-none text-sm",placeholder:"N\xfamero da Ordem"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Especialidade ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",value:A.especialidade,onChange:e=>O({...A,especialidade:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-1 focus:ring-green-500 focus:border-green-500 outline-none text-sm",placeholder:"Ex: Cardiologia, Pediatria, etc."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,r.jsx)("input",{type:"email",value:A.email,onChange:e=>O({...A,email:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-1 focus:ring-green-500 focus:border-green-500 outline-none text-sm",placeholder:"email@exemplo.com"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone"}),(0,r.jsx)("input",{type:"tel",value:A.telefone,onChange:e=>O({...A,telefone:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-1 focus:ring-green-500 focus:border-green-500 outline-none text-sm",placeholder:"+244 923 456 789"})]})]}),(0,r.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)("input",{type:"checkbox",id:"criar_login",checked:A.criar_login,onChange:e=>O({...A,criar_login:e.target.checked}),className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"}),(0,r.jsx)("label",{htmlFor:"criar_login",className:"text-sm font-medium text-gray-700",children:"Criar perfil de acesso (login)"})]}),A.criar_login&&(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email para Login ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"email",value:A.login_email,onChange:e=>O({...A,login_email:e.target.value}),required:A.criar_login,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-1 focus:ring-green-500 focus:border-green-500 outline-none text-sm",placeholder:"email@exemplo.com"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Senha ",!E&&(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"password",value:A.login_password,onChange:e=>O({...A,login_password:e.target.value}),required:A.criar_login&&!E,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-1 focus:ring-green-500 focus:border-green-500 outline-none text-sm",placeholder:E?"Deixe em branco para manter":"Senha"}),E&&(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Deixe em branco para manter a senha atual"})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2 justify-end pt-4 border-t border-gray-200",children:[(0,r.jsx)("button",{type:"button",onClick:F,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium",children:"Cancelar"}),(0,r.jsx)("button",{type:"submit",disabled:T,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors text-sm font-medium flex items-center gap-2",children:T?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.Z,{className:"w-4 h-4 animate-spin"}),"Salvando..."]}):(0,r.jsx)(r.Fragment,{children:E?"Atualizar":"Salvar"})})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase",children:"Nome"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase",children:"N\xba Ordem"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase",children:"Especialidade"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase",children:"Contato"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase",children:"Acesso"}),(0,r.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-700 uppercase",children:"A\xe7\xf5es"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-200",children:0===f.length?(0,r.jsx)("tr",{children:(0,r.jsxs)("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:[(0,r.jsx)(c.Z,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),(0,r.jsx)("p",{children:"Nenhum m\xe9dico cadastrado"})]})}):f.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,r.jsx)("td",{className:"px-4 py-3",children:(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.nome})}),(0,r.jsx)("td",{className:"px-4 py-3",children:(0,r.jsx)("div",{className:"text-sm text-gray-700",children:e.crm})}),(0,r.jsx)("td",{className:"px-4 py-3",children:(0,r.jsx)("div",{className:"text-sm text-gray-700",children:e.especialidade})}),(0,r.jsx)("td",{className:"px-4 py-3",children:(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[e.email&&(0,r.jsx)("div",{children:e.email}),e.telefone&&(0,r.jsx)("div",{children:e.telefone}),!e.email&&!e.telefone&&(0,r.jsx)("span",{className:"text-gray-400",children:"-"})]})}),(0,r.jsx)("td",{className:"px-4 py-3",children:e.user?(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,r.jsx)("span",{className:"text-xs text-green-700 font-medium",children:"Ativo"}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["(",e.user.email,")"]})]}):(0,r.jsx)("span",{className:"text-xs text-gray-400",children:"Sem acesso"})}),(0,r.jsx)("td",{className:"px-4 py-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>{S(e),_(!0)},className:"p-1.5 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Ver detalhes",children:(0,r.jsx)(d.Z,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>B(e),className:"p-1.5 text-gray-600 hover:text-green-600 hover:bg-green-50 rounded transition-colors",title:"Editar",children:(0,r.jsx)(m.Z,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>q({isOpen:!0,id:e.id}),className:"p-1.5 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Excluir",children:(0,r.jsx)(x.Z,{className:"w-4 h-4"})})]})})]},e.id))})]})}),f.length>0&&(0,r.jsx)("div",{className:"bg-gray-50 px-4 py-3 border-t border-gray-200",children:(0,r.jsxs)("p",{className:"text-xs text-gray-600",children:["Total: ",(0,r.jsx)("span",{className:"font-medium text-gray-900",children:f.length})," m\xe9dico",1!==f.length?"s":""]})})]}),w&&k&&(0,r.jsx)(p.Z,{medicoId:k.id,onClose:()=>{_(!1),S(null)},onEdit:()=>{_(!1),C(k),v(!0)}}),(0,r.jsx)(u.Z,{isOpen:M.isOpen,title:"Confirmar Exclus\xe3o",message:"Tem certeza que deseja excluir este m\xe9dico? Esta a\xe7\xe3o n\xe3o pode ser desfeita.",confirmText:"Excluir",cancelText:"Cancelar",type:"danger",onConfirm:P,onCancel:()=>q({isOpen:!1,id:null})})]})}}},function(e){e.O(0,[3803,8481,8548,2971,4938,1744],function(){return e(e.s=2389)}),_N_E=e.O()}]);