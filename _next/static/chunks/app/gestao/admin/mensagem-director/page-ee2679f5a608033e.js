(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5610],{6264:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(2898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9617:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(2898).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},6245:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(2898).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},5438:function(e,t,a){Promise.resolve().then(a.bind(a,1926))},6993:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return r}});let r=a(1024)._(a(2265)).default.createContext(null)},1926:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var r=a(7437),s=a(2265),o=a(8565),n=a(4033),l=a(7504),c=a(6264),i=a(9617),d=a(6245),u=a(6691),m=a.n(u);function g(){let{user:e,token:t,loading:a}=(0,o.a)(),u=(0,n.useRouter)(),[g,h]=(0,s.useState)(null),[p,f]=(0,s.useState)(!0),[x,b]=(0,s.useState)(!1),[y,v]=(0,s.useState)({director_name:"",message:"",published:!0}),[j,w]=(0,s.useState)(null),[N,E]=(0,s.useState)(!1);(0,s.useEffect)(()=>{a||e?e&&"admin"!==e.role&&u.push("/gestao/dashboard"):u.push("/gestao/login")},[e,a,u]);let S=(0,s.useCallback)(async()=>{try{f(!0);let e=await l.h.get("/admin/mensagem-director",t||void 0);e&&(h(e),v({director_name:e.director_name,message:e.message,published:e.published}))}catch(e){console.error("Erro ao buscar mensagem:",e)}finally{f(!1)}},[t]);(0,s.useEffect)(()=>{e&&"admin"===e.role&&S()},[e,S]);let k=async e=>{e.preventDefault(),E(!0);try{let e=new FormData;e.append("director_name",y.director_name),e.append("message",y.message),e.append("published",y.published?"1":"0"),j&&e.append("image",j),g?await l.h.putFormData("/admin/mensagem-director/".concat(g.id),e,t||void 0):await l.h.postFormData("/admin/mensagem-director",e,t||void 0),await S(),b(!1),alert("Mensagem salva com sucesso!")}catch(e){console.error("Erro ao salvar mensagem:",e),alert(e.message||"Erro ao salvar mensagem")}finally{E(!1)}};return a||p?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)(c.Z,{className:"w-8 h-8 animate-spin text-green-600"})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Mensagem do Director Geral"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"Gerencie a mensagem do director geral"})]}),!x&&(0,r.jsx)("button",{onClick:()=>b(!0),className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition",children:g?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{className:"w-5 h-5"}),"Editar Mensagem"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{className:"w-5 h-5"}),"Criar Mensagem"]})})]}),x?(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 border border-gray-200",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:g?"Editar Mensagem":"Nova Mensagem"}),(0,r.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold mb-1",children:"Nome do Director"}),(0,r.jsx)("input",{type:"text",value:y.director_name,onChange:e=>v({...y,director_name:e.target.value}),required:!0,placeholder:"Dr. Nome do Director",className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all bg-gray-50 focus:bg-white outline-none text-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold mb-1",children:"Mensagem"}),(0,r.jsx)("textarea",{value:y.message,onChange:e=>v({...y,message:e.target.value}),required:!0,rows:10,className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all bg-gray-50 focus:bg-white outline-none text-sm resize-y",placeholder:"Escreva a mensagem do director aqui..."})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold mb-1",children:"Foto do Director"}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;return w((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)},className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all bg-gray-50 focus:bg-white outline-none text-sm file:mr-4 file:py-1 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100 cursor-pointer"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 pt-6",children:[(0,r.jsx)("input",{type:"checkbox",id:"published",checked:y.published,onChange:e=>v({...y,published:e.target.checked}),className:"w-4 h-4"}),(0,r.jsx)("label",{htmlFor:"published",className:"text-sm font-semibold",children:"Publicado"})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{type:"submit",disabled:N,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50",children:N?"Salvando...":"Salvar"}),(0,r.jsx)("button",{type:"button",onClick:()=>{b(!1),g&&v({director_name:g.director_name,message:g.message,published:g.published})},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancelar"})]})]})]}):(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 p-6",children:g?(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"flex items-start gap-6",children:[g.image&&(0,r.jsx)(m(),{src:"".concat("https://clamatec.com/api".replace("/api",""),"/storage/").concat(g.image),alt:g.director_name,width:150,height:150,className:"rounded-lg object-cover"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:g.director_name}),(0,r.jsx)("div",{className:"prose max-w-none",children:(0,r.jsx)("p",{className:"text-gray-700 whitespace-pre-line leading-relaxed",children:g.message})}),(0,r.jsx)("div",{className:"mt-4",children:g.published?(0,r.jsx)("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-semibold",children:"Publicado"}):(0,r.jsx)("span",{className:"px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm font-semibold",children:"Rascunho"})})]})]})}):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"Nenhuma mensagem cadastrada ainda."}),(0,r.jsxs)("button",{onClick:()=>b(!0),className:"inline-flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition",children:[(0,r.jsx)(d.Z,{className:"w-5 h-5"}),"Criar Mensagem"]})]})})]})}},8565:function(e,t,a){"use strict";a.d(t,{H:function(){return c},a:function(){return i}});var r=a(7437),s=a(2265),o=a(4829);let n=window.__API_URL__||"https://clamatec.com/api",l=(0,s.createContext)(void 0);function c(e){let{children:t}=e,[a,c]=(0,s.useState)(null),[i,d]=(0,s.useState)(null),[u,m]=(0,s.useState)(!0);(0,s.useEffect)(()=>{try{let e=localStorage.getItem("token"),t=localStorage.getItem("user");if(!e||!t||"undefined"===e||"null"===e||"undefined"===t||"null"===t||""===e.trim()||""===t.trim()){localStorage.removeItem("token"),localStorage.removeItem("user"),m(!1);return}try{let a=JSON.parse(t);if(a&&"object"==typeof a&&a.id)d(e),c(a);else throw Error("User object invalid")}catch(e){console.error("Erro ao fazer parse do usu\xe1rio do localStorage:",e),localStorage.removeItem("token"),localStorage.removeItem("user")}}catch(e){console.error("Erro ao acessar localStorage:",e);try{localStorage.removeItem("token"),localStorage.removeItem("user")}catch(e){}}finally{m(!1)}},[]);let g=async(e,t)=>{try{let{token:a,user:r}=(await o.Z.post("".concat(n,"/login"),{email:e,password:t},{headers:{"Content-Type":"application/json"},withCredentials:!0})).data;d(a),c(r),localStorage.setItem("token",a),localStorage.setItem("user",JSON.stringify(r))}catch(e){var a,r;throw Error((null===(r=e.response)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.message)||"Erro ao fazer login")}},h=async()=>{if(i)try{await o.Z.post("".concat(n,"/logout"),{},{headers:{Authorization:"Bearer ".concat(i)}})}catch(e){console.error("Erro ao fazer logout:",e)}d(null),c(null),localStorage.removeItem("token"),localStorage.removeItem("user")};return(0,r.jsx)(l.Provider,{value:{user:a,token:i,loading:u,login:g,logout:h},children:t})}function i(){let e=(0,s.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7504:function(e,t,a){"use strict";a.d(t,{h:function(){return s}});let r=window.__API_URL__||"https://clamatec.com/api",s={get:async(e,t)=>{let a={"Content-Type":"application/json"};t&&(a.Authorization="Bearer ".concat(t));let s=await fetch("".concat(r).concat(e),{method:"GET",headers:a});if(!s.ok)throw Error("API Error: ".concat(s.statusText));return s.json()},post:async(e,t,a)=>{let s={"Content-Type":"application/json"};a&&(s.Authorization="Bearer ".concat(a));let o=await fetch("".concat(r).concat(e),{method:"POST",headers:s,body:JSON.stringify(t)});if(!o.ok)throw Error((await o.json().catch(()=>({message:o.statusText}))).message||"API Error: ".concat(o.statusText));return o.json()},put:async(e,t,a)=>{let s={"Content-Type":"application/json"};a&&(s.Authorization="Bearer ".concat(a));let o=await fetch("".concat(r).concat(e),{method:"PUT",headers:s,body:JSON.stringify(t)});if(!o.ok)throw Error((await o.json().catch(()=>({message:o.statusText}))).message||"API Error: ".concat(o.statusText));return o.json()},delete:async(e,t)=>{let a={"Content-Type":"application/json"};t&&(a.Authorization="Bearer ".concat(t));let s=await fetch("".concat(r).concat(e),{method:"DELETE",headers:a});if(!s.ok)throw Error("API Error: ".concat(s.statusText));return 204===s.status?null:s.json()},postFormData:async(e,t,a)=>{let s={};a&&(s.Authorization="Bearer ".concat(a));let o=await fetch("".concat(r).concat(e),{method:"POST",headers:s,body:t});if(!o.ok)throw Error((await o.json().catch(()=>({message:o.statusText}))).message||"API Error: ".concat(o.statusText));return o.json()},putFormData:async(e,t,a)=>{let s={};a&&(s.Authorization="Bearer ".concat(a));let o=await fetch("".concat(r).concat(e),{method:"POST",headers:{...s,"X-HTTP-Method-Override":"PUT"},body:t});if(!o.ok)throw Error((await o.json().catch(()=>({message:o.statusText}))).message||"API Error: ".concat(o.statusText));return o.json()}}},4033:function(e,t,a){e.exports=a(5313)}},function(e){e.O(0,[3803,6691,2971,4938,1744],function(){return e(e.s=5438)}),_N_E=e.O()}]);