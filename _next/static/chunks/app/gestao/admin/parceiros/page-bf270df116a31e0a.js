(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7775],{6264:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9617:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},9883:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1138:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},148:function(e,t,r){Promise.resolve().then(r.bind(r,1374))},1374:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var a=r(7437),o=r(2265),s=r(8565),l=r(4033),n=r(7504),c=r(6264),i=r(9883),d=r(9617),u=r(1138);function h(){let{user:e,token:t,loading:r}=(0,s.a)(),h=(0,l.useRouter)(),[m,p]=(0,o.useState)([]),[x,g]=(0,o.useState)(!0),[f,y]=(0,o.useState)(!1),[b,j]=(0,o.useState)(null),[v,N]=(0,o.useState)({name:"",url:"",published:!0,order:0}),[w,k]=(0,o.useState)(null),[E,S]=(0,o.useState)(!1);(0,o.useEffect)(()=>{r||e?e&&"admin"!==e.role&&h.push("/gestao/dashboard"):h.push("/gestao/login")},[e,r,h]);let P=(0,o.useCallback)(async()=>{try{g(!0);let e=await n.h.get("/admin/parceiros",t||void 0);p(e)}catch(e){console.error("Erro ao buscar parceiros:",e),alert("Erro ao carregar parceiros")}finally{g(!1)}},[t]);(0,o.useEffect)(()=>{e&&"admin"===e.role&&P()},[e,P]);let T=async e=>{e.preventDefault(),S(!0);try{let e=new FormData;e.append("name",v.name),e.append("url",v.url),e.append("published",v.published?"1":"0"),e.append("order",v.order.toString()),w&&e.append("logo",w),b?await n.h.putFormData("/admin/parceiros/".concat(b.id),e,t||void 0):await n.h.postFormData("/admin/parceiros",e,t||void 0),await P(),A(),alert(b?"Parceiro atualizado com sucesso!":"Parceiro criado com sucesso!")}catch(e){console.error("Erro ao salvar parceiro:",e),alert(e.message||"Erro ao salvar parceiro")}finally{S(!1)}},C=async e=>{if(confirm("Tem certeza que deseja deletar este parceiro?"))try{await n.h.delete("/admin/parceiros/".concat(e),t||void 0),await P(),alert("Parceiro deletado com sucesso!")}catch(e){console.error("Erro ao deletar parceiro:",e),alert("Erro ao deletar parceiro")}},I=e=>{j(e),N({name:e.name,url:e.url||"",published:e.published,order:e.order}),y(!0)},A=()=>{N({name:"",url:"",published:!0,order:0}),k(null),j(null),y(!1)};return r||x?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)(c.Z,{className:"w-8 h-8 animate-spin text-green-600"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Parceiros"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Gerencie os parceiros do hospital"})]}),(0,a.jsxs)("button",{onClick:()=>y(!0),className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition",children:[(0,a.jsx)(i.Z,{className:"w-5 h-5"}),"Novo Parceiro"]})]}),f&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 border border-gray-200",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:b?"Editar Parceiro":"Novo Parceiro"}),(0,a.jsxs)("form",{onSubmit:T,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold mb-1",children:"Nome"}),(0,a.jsx)("input",{type:"text",value:v.name,onChange:e=>N({...v,name:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold mb-1",children:"URL"}),(0,a.jsx)("input",{type:"url",value:v.url,onChange:e=>N({...v,url:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold mb-1",children:"Logo"}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;return k((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold mb-1",children:"Ordem"}),(0,a.jsx)("input",{type:"number",value:v.order,onChange:e=>N({...v,order:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"published",checked:v.published,onChange:e=>N({...v,published:e.target.checked}),className:"w-4 h-4"}),(0,a.jsx)("label",{htmlFor:"published",className:"text-sm font-semibold",children:"Publicado"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"submit",disabled:E,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50",children:E?"Salvando...":b?"Atualizar":"Criar"}),(0,a.jsx)("button",{type:"button",onClick:A,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancelar"})]})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Nome"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"URL"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase",children:"A\xe7\xf5es"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:m.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 font-semibold",children:e.name}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-blue-600",children:e.url?(0,a.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:e.url}):"-"}),(0,a.jsx)("td",{className:"px-6 py-4",children:e.published?(0,a.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs",children:"Publicado"}):(0,a.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 rounded-full text-xs",children:"Rascunho"})}),(0,a.jsx)("td",{className:"px-6 py-4 text-right",children:(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>I(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition",children:(0,a.jsx)(d.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>C(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",children:(0,a.jsx)(u.Z,{className:"w-4 h-4"})})]})})]},e.id))})]})})})]})}},8565:function(e,t,r){"use strict";r.d(t,{H:function(){return c},a:function(){return i}});var a=r(7437),o=r(2265),s=r(4829);let l=window.__API_URL__||"https://clamatec.com/api",n=(0,o.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,o.useState)(null),[i,d]=(0,o.useState)(null),[u,h]=(0,o.useState)(!0);(0,o.useEffect)(()=>{try{let e=localStorage.getItem("token"),t=localStorage.getItem("user");if(!e||!t||"undefined"===e||"null"===e||"undefined"===t||"null"===t||""===e.trim()||""===t.trim()){localStorage.removeItem("token"),localStorage.removeItem("user"),h(!1);return}try{let r=JSON.parse(t);if(r&&"object"==typeof r&&r.id)d(e),c(r);else throw Error("User object invalid")}catch(e){console.error("Erro ao fazer parse do usu\xe1rio do localStorage:",e),localStorage.removeItem("token"),localStorage.removeItem("user")}}catch(e){console.error("Erro ao acessar localStorage:",e);try{localStorage.removeItem("token"),localStorage.removeItem("user")}catch(e){}}finally{h(!1)}},[]);let m=async(e,t)=>{try{let{token:r,user:a}=(await s.Z.post("".concat(l,"/login"),{email:e,password:t},{headers:{"Content-Type":"application/json"},withCredentials:!0})).data;d(r),c(a),localStorage.setItem("token",r),localStorage.setItem("user",JSON.stringify(a))}catch(e){var r,a;throw Error((null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)||"Erro ao fazer login")}},p=async()=>{if(i)try{await s.Z.post("".concat(l,"/logout"),{},{headers:{Authorization:"Bearer ".concat(i)}})}catch(e){console.error("Erro ao fazer logout:",e)}d(null),c(null),localStorage.removeItem("token"),localStorage.removeItem("user")};return(0,a.jsx)(n.Provider,{value:{user:r,token:i,loading:u,login:m,logout:p},children:t})}function i(){let e=(0,o.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7504:function(e,t,r){"use strict";r.d(t,{h:function(){return o}});let a=window.__API_URL__||"https://clamatec.com/api",o={get:async(e,t)=>{let r={"Content-Type":"application/json"};t&&(r.Authorization="Bearer ".concat(t));let o=await fetch("".concat(a).concat(e),{method:"GET",headers:r});if(!o.ok)throw Error("API Error: ".concat(o.statusText));return o.json()},post:async(e,t,r)=>{let o={"Content-Type":"application/json"};r&&(o.Authorization="Bearer ".concat(r));let s=await fetch("".concat(a).concat(e),{method:"POST",headers:o,body:JSON.stringify(t)});if(!s.ok)throw Error((await s.json().catch(()=>({message:s.statusText}))).message||"API Error: ".concat(s.statusText));return s.json()},put:async(e,t,r)=>{let o={"Content-Type":"application/json"};r&&(o.Authorization="Bearer ".concat(r));let s=await fetch("".concat(a).concat(e),{method:"PUT",headers:o,body:JSON.stringify(t)});if(!s.ok)throw Error((await s.json().catch(()=>({message:s.statusText}))).message||"API Error: ".concat(s.statusText));return s.json()},delete:async(e,t)=>{let r={"Content-Type":"application/json"};t&&(r.Authorization="Bearer ".concat(t));let o=await fetch("".concat(a).concat(e),{method:"DELETE",headers:r});if(!o.ok)throw Error("API Error: ".concat(o.statusText));return 204===o.status?null:o.json()},postFormData:async(e,t,r)=>{let o={};r&&(o.Authorization="Bearer ".concat(r));let s=await fetch("".concat(a).concat(e),{method:"POST",headers:o,body:t});if(!s.ok)throw Error((await s.json().catch(()=>({message:s.statusText}))).message||"API Error: ".concat(s.statusText));return s.json()},putFormData:async(e,t,r)=>{let o={};r&&(o.Authorization="Bearer ".concat(r));let s=await fetch("".concat(a).concat(e),{method:"POST",headers:{...o,"X-HTTP-Method-Override":"PUT"},body:t});if(!s.ok)throw Error((await s.json().catch(()=>({message:s.statusText}))).message||"API Error: ".concat(s.statusText));return s.json()}}},4033:function(e,t,r){e.exports=r(5313)}},function(e){e.O(0,[3803,2971,4938,1744],function(){return e(e.s=148)}),_N_E=e.O()}]);