(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7560],{1981:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},2894:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},3008:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3523:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},1291:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},7158:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},4056:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},6264:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},6245:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},7607:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("Stethoscope",[["path",{d:"M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3",key:"1jd90r"}],["path",{d:"M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4",key:"126ukv"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]])},2549:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},6127:function(e,t,r){Promise.resolve().then(r.bind(r,8799))},8799:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var a=r(7437),s=r(2265),n=r(8565),o=r(4033),i=r(6264),l=r(1291),c=r(7158),d=r(6245),u=r(2549);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,r(2898).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var m=r(3242),g=r(9173),x=r(7607);function p(){let{user:e,token:t,loading:r}=(0,n.a)(),p=(0,o.useRouter)(),[f,v]=(0,s.useState)([]),[y,b]=(0,s.useState)(""),[j,w]=(0,s.useState)([]),[N,S]=(0,s.useState)(!0),[k,Z]=(0,s.useState)(!1),[E,A]=(0,s.useState)(new Date),[D,C]=(0,s.useState)(new Set);(0,s.useEffect)(()=>{r||e||p.push("/gestao/login")},[e,r,p]),(0,s.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat("https://clamatec.com/api","/medicos"),{headers:{Authorization:"Bearer ".concat(t)}});if(e.ok){let t=await e.json(),r=Array.isArray(t)?t:t.data||[];v(r)}}catch(e){console.error("Erro ao buscar m\xe9dicos:",e)}};t&&e()},[t]);let I=(0,s.useCallback)(async()=>{if(!y){w([]),S(!1);return}try{S(!0);let e=new Date(E.getFullYear(),E.getMonth(),1).toISOString().split("T")[0],r=await fetch("".concat("https://clamatec.com/api","/admin/medico-horarios?medico_id=").concat(y,"&mes=").concat(e),{headers:{Authorization:"Bearer ".concat(t)}});if(r.ok){let e=((await r.json()).data||[]).map(e=>{let t=e.data;return"string"==typeof t&&t.includes("T")?t=t.split("T")[0]:t instanceof Date&&(t=t.toISOString().split("T")[0]),{...e,data:t}});w(e);let t=new Set;e.forEach(e=>{e.disponivel&&e.data&&t.add(e.data)}),C(t)}else{let e=await r.json().catch(()=>({}));console.error("Erro ao buscar hor\xe1rios:",r.status,e),m.A.error("Erro ao carregar hor\xe1rios")}}catch(e){console.error("Erro ao buscar hor\xe1rios:",e),m.A.error("Erro ao carregar hor\xe1rios")}finally{S(!1)}},[t,y,E]);(0,s.useEffect)(()=>{t&&y&&I()},[I]);let T=e=>{let t=e.toISOString().split("T")[0],r=new Set(D);r.has(t)?r.delete(t):r.add(t),C(r)},M=async()=>{if(!y){m.A.error("Selecione um m\xe9dico");return}if(0===D.size){m.A.error("Selecione pelo menos um dia");return}Z(!0);try{let e=Array.from(D).map(e=>e.includes("T")?e.split("T")[0]:e),r=await fetch("".concat("https://clamatec.com/api","/admin/medico-horarios/bulk"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({medico_id:parseInt(y),datas:e,hora_inicio:null,hora_fim:null,disponivel:!0})});if(!r.ok){let e=await r.json().catch(()=>({})),t=e.errors?Object.values(e.errors).flat().join(", "):e.message||"Erro ao salvar hor\xe1rios";throw Error(t)}let a=(await r.json()).data||[];m.A.success("".concat(a.length," hor\xe1rio(s) salvo(s) com sucesso!")),await I()}catch(e){console.error("Erro ao salvar hor\xe1rios:",e),m.A.error(e.message||"Erro ao salvar hor\xe1rios")}finally{Z(!1)}},z=async e=>{let r=e.toISOString().split("T")[0],a=j.find(e=>e.data===r);if(a)try{(await fetch("".concat("https://clamatec.com/api","/admin/medico-horarios/").concat(a.id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok?(m.A.success("Dia removido com sucesso!"),I()):m.A.error("Erro ao remover dia")}catch(e){m.A.error("Erro ao remover dia")}},_=e=>{let t=new Date(E);t.setMonth(t.getMonth()+("next"===e?1:-1)),A(t)},O=e=>{let t=e.toISOString().split("T")[0];return j.find(e=>("string"==typeof e.data?e.data.split("T")[0]:String(e.data).split("T")[0])===t)},F=e=>{let t=new Date;return t.setHours(0,0,0,0),e<t};return r||N?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)(i.Z,{className:"w-8 h-8 animate-spin text-green-600"})}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Dias de Trabalho"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Defina os dias de trabalho dos m\xe9dicos"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)(g.Z,{label:"Selecione o M\xe9dico",value:y,onChange:e=>{b(e.target.value),C(new Set)},icon:(0,a.jsx)(x.Z,{className:"w-4 h-4"}),children:[(0,a.jsx)("option",{value:"",children:"Selecione um m\xe9dico"}),f.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.nome," ",e.especialidade?"- ".concat(e.especialidade):""]},e.id))]})})})}),y&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("button",{onClick:()=>_("prev"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,a.jsx)(l.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:[["Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][E.getMonth()]," ",E.getFullYear()]}),(0,a.jsx)("button",{onClick:()=>_("next"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,a.jsx)(c.Z,{className:"w-5 h-5"})}),(0,a.jsx)("button",{onClick:()=>{A(new Date)},className:"ml-4 px-3 py-1.5 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Hoje"})]}),(0,a.jsx)("button",{onClick:M,disabled:k||0===D.size,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors text-sm font-medium flex items-center gap-2",children:k?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{className:"w-4 h-4 animate-spin"}),"Salvando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.Z,{className:"w-4 h-4"}),"Salvar Dias Selecionados"]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-7 gap-2",children:[["Dom","Seg","Ter","Qua","Qui","Sex","S\xe1b"].map((e,t)=>(0,a.jsx)("div",{className:"text-center text-xs font-medium text-gray-500 py-2",children:e},t)),(e=>{let t=e.getFullYear(),r=e.getMonth(),a=new Date(t,r,1),s=new Date(t,r+1,0).getDate(),n=a.getDay(),o=[];for(let e=0;e<n;e++)o.push(null);for(let e=1;e<=s;e++)o.push(new Date(t,r,e));return o})(E).map((e,t)=>{if(!e)return(0,a.jsx)("div",{className:"min-h-[80px]"},t);let r=e.toISOString().split("T")[0],s=O(e),n=D.has(r)||s&&s.disponivel,o=F(e),i=e.toDateString()===new Date().toDateString();return(0,a.jsxs)("div",{className:"min-h-[80px] border rounded-lg p-2 transition-colors ".concat(o?"bg-gray-100 border-gray-200 opacity-50 cursor-not-allowed":n||s&&s.disponivel?"bg-green-50 border-green-400 cursor-pointer hover:bg-green-100":"bg-white border-gray-200 cursor-pointer hover:bg-gray-50"," ").concat(i?"ring-2 ring-green-500":""),onClick:()=>{o||T(e)},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-sm font-medium ".concat(n?"text-green-700":"text-gray-700"),children:e.getDate()}),s&&!o&&(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),z(e)},className:"p-0.5 text-red-600 hover:text-red-700 hover:bg-red-50 rounded",title:"Remover",children:(0,a.jsx)(u.Z,{className:"w-3 h-3"})})]}),s&&s.disponivel&&(0,a.jsxs)("div",{className:"text-xs text-green-600 flex items-center gap-1 mt-1",children:[(0,a.jsx)(h,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:"Dispon\xedvel"})]}),n&&!s&&(0,a.jsxs)("div",{className:"text-xs text-green-600 mt-1 flex items-center gap-1",children:[(0,a.jsx)(h,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:"Selecionado"})]})]},t)})]}),(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 bg-green-50 border border-green-400 rounded"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Dia selecionado"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 bg-gray-100 border border-gray-200 rounded opacity-50"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Dia passado (n\xe3o edit\xe1vel)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 bg-white border-2 border-green-500 rounded"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Hoje"})]})]})})]})})]})}},9173:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var a=r(7437),s=r(3523);function n(e){let{children:t,label:r,error:n,icon:o,className:i="",options:l,...c}=e;return(0,a.jsxs)("div",{className:r?"w-full":"",children:[r&&(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[r,c.required&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,a.jsxs)("div",{className:"relative",children:[o&&(0,a.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none z-10",children:o}),(0,a.jsx)("select",{...c,className:"\n            ".concat(r?"w-full":"min-w-[140px]"," \n            ").concat(o?"pl-10":"pl-3"," \n            pr-10 \n            py-2.5 \n            border \n            border-gray-300 \n            rounded-lg \n            bg-white\n            text-sm\n            text-gray-900\n            font-medium\n            appearance-none\n            cursor-pointer\n            transition-all\n            duration-200\n            focus:ring-2 \n            focus:ring-green-500/50\n            focus:border-green-500 \n            outline-none\n            hover:border-gray-400\n            hover:bg-gray-50\n            disabled:bg-gray-100 \n            disabled:cursor-not-allowed\n            disabled:text-gray-500\n            disabled:border-gray-200\n            ").concat(n?"border-red-500 focus:border-red-500 focus:ring-red-500/50":"","\n            ").concat(i,"\n          "),children:l?l.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value)):t}),(0,a.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none text-gray-500",children:(0,a.jsx)(s.Z,{className:"w-4 h-4"})})]}),n&&(0,a.jsxs)("p",{className:"mt-1.5 text-xs text-red-600 flex items-center gap-1",children:[(0,a.jsx)("span",{children:"âš "}),n]})]})}},3242:function(e,t,r){"use strict";r.d(t,{A:function(){return g},I:function(){return x}});var a=r(7437),s=r(2265),n=r(3008),o=r(1981),i=r(2894),l=r(4056),c=r(2549);let d=0,u=[],h=[],m=()=>{u.forEach(e=>e([...h]))},g={show:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,a="toast-".concat(++d);return h.push({id:a,message:e,type:t,duration:r}),m(),r>0&&setTimeout(()=>{g.remove(a)},r),a},success:(e,t)=>g.show(e,"success",t),error:(e,t)=>g.show(e,"error",t),info:(e,t)=>g.show(e,"info",t),warning:(e,t)=>g.show(e,"warning",t),remove:e=>{h=h.filter(t=>t.id!==e),m()}};function x(){let[e,t]=(0,s.useState)([]);(0,s.useEffect)(()=>{let e=e=>{t(e)};return u.push(e),t([...h]),()=>{u=u.filter(t=>t!==e)}},[]);let r=e=>{switch(e){case"success":return(0,a.jsx)(n.Z,{className:"w-5 h-5 text-green-600"});case"error":return(0,a.jsx)(o.Z,{className:"w-5 h-5 text-red-600"});case"warning":return(0,a.jsx)(i.Z,{className:"w-5 h-5 text-yellow-600"});default:return(0,a.jsx)(l.Z,{className:"w-5 h-5 text-blue-600"})}},d=e=>{switch(e){case"success":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";default:return"bg-blue-50 border-blue-200 text-blue-800"}};return 0===e.length?null:(0,a.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-md w-full",children:e.map(e=>(0,a.jsxs)("div",{className:"\n            ".concat(d(e.type),"\n            border-2 rounded-xl shadow-lg p-4 flex items-start gap-3\n            animate-in slide-in-from-right-full duration-300\n            backdrop-blur-sm\n          "),children:[(0,a.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:r(e.type)}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)("p",{className:"text-sm font-semibold break-words",children:e.message})}),(0,a.jsx)("button",{onClick:()=>e.remove(e.id),className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors",children:(0,a.jsx)(c.Z,{className:"w-4 h-4"})})]},e.id))})}},8565:function(e,t,r){"use strict";r.d(t,{H:function(){return l},a:function(){return c}});var a=r(7437),s=r(2265),n=r(4829);let o=window.__API_URL__||"https://clamatec.com/api",i=(0,s.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[u,h]=(0,s.useState)(!0);(0,s.useEffect)(()=>{try{let e=localStorage.getItem("token"),t=localStorage.getItem("user");if(!e||!t||"undefined"===e||"null"===e||"undefined"===t||"null"===t||""===e.trim()||""===t.trim()){localStorage.removeItem("token"),localStorage.removeItem("user"),h(!1);return}try{let r=JSON.parse(t);if(r&&"object"==typeof r&&r.id)d(e),l(r);else throw Error("User object invalid")}catch(e){console.error("Erro ao fazer parse do usu\xe1rio do localStorage:",e),localStorage.removeItem("token"),localStorage.removeItem("user")}}catch(e){console.error("Erro ao acessar localStorage:",e);try{localStorage.removeItem("token"),localStorage.removeItem("user")}catch(e){}}finally{h(!1)}},[]);let m=async(e,t)=>{try{let{token:r,user:a}=(await n.Z.post("".concat(o,"/login"),{email:e,password:t},{headers:{"Content-Type":"application/json"},withCredentials:!0})).data;d(r),l(a),localStorage.setItem("token",r),localStorage.setItem("user",JSON.stringify(a))}catch(e){var r,a;throw Error((null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)||"Erro ao fazer login")}},g=async()=>{if(c)try{await n.Z.post("".concat(o,"/logout"),{},{headers:{Authorization:"Bearer ".concat(c)}})}catch(e){console.error("Erro ao fazer logout:",e)}d(null),l(null),localStorage.removeItem("token"),localStorage.removeItem("user")};return(0,a.jsx)(i.Provider,{value:{user:r,token:c,loading:u,login:m,logout:g},children:t})}function c(){let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4033:function(e,t,r){e.exports=r(5313)}},function(e){e.O(0,[3803,2971,4938,1744],function(){return e(e.s=6127)}),_N_E=e.O()}]);